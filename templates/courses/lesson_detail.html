{% extends "base.html" %}

{% block title %}{{ lesson.title }} | Evolaris Academy{% endblock %}

{% block content %}
<!-- Dark Header (UI Consistency) -->
<header class="lesson-hero">
    <nav class="back-nav">
        <a href="{% url 'courses:course_detail' lesson.module.course.slug %}">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back to course: {{ lesson.module.course.title }}
        </a>
    </nav>
    <div class="lesson-meta" style="margin-bottom: var(--space-2); font-size: var(--text-sm); color: rgba(255,255,255,0.6);">
        {{ lesson.module.title }} &bull; Lesson {{ lesson.order }}
    </div>
    <h1 style="margin: 0; font-size: var(--text-2xl);">{{ lesson.title }}</h1>
</header>

<div class="lesson-layout">
    <!-- Main Content -->
    <main>
        {% if lesson.video_url %}
            <div class="video-container">
                <iframe src="{{ lesson.video_url }}" allowfullscreen></iframe>
            </div>
        {% endif %}

        <article class="lesson-body">
            <div class="lesson-content">
                {{ lesson.content|linebreaks }}
            </div>

            <!-- Bottom Navigation -->
            <footer class="lesson-footer-nav">
                <div style="display: flex; gap: var(--space-4);">
                    <button class="btn btn--outline" title="Coming soon">
                        &larr; Previous
                    </button>
                    <button class="btn btn--outline" title="Coming soon">
                        Next &rarr;
                    </button>
                </div>

                <form method="post" action="#">
                    {% csrf_token %}
                    <button type="button" class="btn btn--primary" onclick="alert('Progress logic in Module 6')">
                        Mark as completed
                    </button>
                </form>
            </footer>
        </article>
    </main>

    <!-- Module Navigation Sidebar -->
    <aside class="lesson-sidebar">
        <div class="sidebar-header">
            MODULE CONTENT
        </div>
        <nav class="sidebar-nav">
            {% for item in module_lessons %}
                <a href="{% url 'courses:lesson_detail' lesson.module.course.slug item.slug %}" 
                   class="sidebar-item {% if item.id == lesson.id %}active{% endif %}">
                    <span class="item-status">
                        {% if item.id == lesson.id %}▶{% else %}○{% endif %}
                    </span>
                    {{ item.title }}
                </a>
            {% endfor %}
        </nav>
        <div style="padding: var(--space-4); border-top: 1px solid var(--border-color);">
            <a href="{% url 'courses:course_list' %}" style="font-size: var(--text-sm); color: var(--text-muted);">
                &laquo; Exit to catalogue
            </a>
        </div>
    </aside>
</div>
{% endblock %}